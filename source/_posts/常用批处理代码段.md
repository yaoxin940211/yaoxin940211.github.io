---
title: 常用批处理代码段
date: 2019-03-14 21:27:33
tags: [批处理, bat]
categories: 批处理
---
[TOC]

# 常用批处理代码段
<!--More-->
## 监测程序是否运行并自动启动
```bat
@echo off

set APPName=unity.exe
set APPPath=C:\Progra~1\Unity5.6.4p3\Editor\

:startapp
    tasklist|findstr /i %APPName% > nul

    if %errorlevel% == 0 (
        echo ^>%date:~0,10% %time:~0,8% "程序正在运行中..."
    ) else (
        echo ^>%date:~0,10% %time:~0,8% "程序未运行..."
        start %APPPath%%AppName% 2>nul && echo ^>%date:~0,10% %time:~0,8% "程序启动成功..."
    )
    rem 等待5秒
    for /l %%i in (1,1,5) do (
        ping -n 1 -w 1000 125.0.0.1>nul
    )
    goto startapp
```

## 打开资源管理器并选中某个文件
```bat
@echo off

set dir=D:\Test
if not exist %dir%\%1.xlsx (
	echo No Such File
	pause
	exit
)
svn revert %dir%\%1.xlsx
svn up %dir%\%1.xlsx
rem important!
explorer /select,%dir%\%1.xlsx
```

## 目录解析
```bat
@echo off
rem 1.获取批处理自身的完整路径
echo %0
rem 2.获取批处理自身的完整路径，并去掉首尾的引号
echo %~0
rem 3.获取批处理自身的文件名和后缀名
echo %~nx0
rem 4.获取批处理自身的文件名
echo %~n0
rem 5.获取批处理自身的后缀名
echo %~x0
rem 6.获取批处理自身的完整路径，不含文件名
echo %~dp0
rem 7.获取批处理自身的盘符
echo %~d0
rem 8.获取批处理自身的大小
echo %~z0
rem 9.获取批处理自身的修改时间
echo %~t0
pause
```